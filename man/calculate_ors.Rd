% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ors.R
\name{calculate_ors}
\alias{calculate_ors}
\title{Calculate ortholog rank score (ORS)}
\usage{
calculate_ors(ccs_results, return_log = TRUE)
}
\arguments{
\item{ccs_results}{Data frame from \code{calculate_ccs()} with CCS values}

\item{return_log}{Logical. If TRUE (default), returns logORS which is more
suitable for visualization. If FALSE, returns raw ORS proportion.}
}
\value{
Input data frame with added columns:
\itemize{
\item \code{ors_sp1_to_sp2}: ORS from species 1 perspective (for multi-copy)
\item \code{ors_sp2_to_sp1}: ORS from species 2 perspective (for multi-copy)
\item \code{ors_mean}: Mean of bidirectional ORS (recommended for analysis)
\item \code{logors} (if return_log=TRUE): -log10 transformed ORS
}
}
\description{
Calculates ORS which measures the statistical significance of co-expression
conservation. Higher ORS indicates stronger evidence that orthologous genes
have conserved co-expression partners.
}
\details{
ORS is calculated as the proportion of ortholog pairs with CCS less than or
equal to the CCS of the focal ortholog pair: \code{ORS_ij = P(CCS <= CCS_ij)}

For multi-copy orthologs (1:N, N:1, N:M), directional ORS is calculated
separately for each species direction by grouping on the gene from that
species. For 1:1 orthologs, both directions use global ranking.

The mean bidirectional ORS is then log-transformed:
\code{logORS_ij = -log10(1 + 10^-4 - (ORS^sp1_ij + ORS^sp2_ji)/2)}

Interpretation of logORS:
\itemize{
\item >1: Ortholog is in top 10
\item >2: Top 1
\item >3: Top 0.1
\item <0: Below median (diverged)
}
}
\examples{
\dontrun{
ccs_results <- calculate_ccs(sim_at, sim_os, orthologs)
ors_results <- calculate_ors(ccs_results)

# Filter highly conserved orthologs
conserved <- ors_results |> dplyr::filter(logors > 2)
}

}
\references{
Gr√∏nvold L, Hvidsten TR. Cross species comparative transcriptomics using
co-expression networks.
}
