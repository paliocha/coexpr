% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{mutual_rank_transform_tri_cpp}
\alias{mutual_rank_transform_tri_cpp}
\title{Cached mutual rank transformation returning triangular format}
\usage{
mutual_rank_transform_tri_cpp(sim_pcc, n_cores = 1L)
}
\arguments{
\item{sim_pcc}{Symmetric Pearson correlation matrix (n x n)}

\item{n_cores}{Number of OpenMP threads to use (default: 1)}
}
\value{
List with components:
\itemize{
\item data: numeric vector of upper triangle values (column-major, excluding diagonal)
\item n: number of genes
\item diag_value: diagonal value (always 1.0 for PCC+MR)
}
}
\description{
Transforms a Pearson correlation matrix into a PCC+MR similarity matrix
and returns only the upper triangle (excluding diagonal) for memory efficiency.
This reduces storage by approximately 50\%.
}
\details{
The upper triangle is returned in column-major order, which matches R's
upper.tri() ordering. For a matrix with n genes, the returned vector has
n*(n-1)/2 elements.

The transformation is the same as mutual_rank_transform_cached_cpp:
\deqn{S^{PCC+MR}_{ij} = 1 - \frac{\log(\sqrt{R_{ij} \cdot R_{ji}})}{\log(n)}}

The upper triangle extraction follows column-major order:
For positions (i,j) with i < j, elements are ordered by increasing j,
then by increasing i within each column.
}
