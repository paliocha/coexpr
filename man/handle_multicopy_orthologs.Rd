% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multicopy.R
\name{handle_multicopy_orthologs}
\alias{handle_multicopy_orthologs}
\title{Handle multi-copy orthologs}
\usage{
handle_multicopy_orthologs(
  orthologs,
  strategy = c("strict", "best_hit", "mean", "max", "all_pairs"),
  ccs_values = NULL,
  similarity_sp1 = NULL,
  similarity_sp2 = NULL
)
}
\arguments{
\item{orthologs}{Data frame with columns \code{gene_sp1} and \code{gene_sp2}.
Optionally include \code{type} column with values "1:1", "1:N", "N:1", "N:M".}

\item{strategy}{Character. Strategy for handling multi-copy orthologs:
\itemize{
\item \code{"strict"} (default): Keep only 1:1 orthologs (matches paper)
\item \code{"best_hit"}: For 1:N, select best copy; for N:M, select best reciprocal pair
\item \code{"mean"}: Average CCS across all copies (requires CCS pre-calculated)
\item \code{"max"}: Use maximum CCS (most conserved copy, requires CCS pre-calculated)
\item \code{"all_pairs"}: Keep all combinations (increases dataset size)
}}

\item{ccs_values}{Optional. Pre-calculated CCS values (required for "mean" and "max")}

\item{similarity_sp1}{Optional. Similarity matrix for species 1 (for "best_hit")}

\item{similarity_sp2}{Optional. Similarity matrix for species 2 (for "best_hit")}
}
\value{
Processed orthologs data frame suitable for CCS calculation
}
\description{
Resolves how to handle 1:N and N:M ortholog relationships for CCS calculation.
The paper (Grønvold & Hvidsten) uses only 1:1 orthologs, but this function
provides several strategies for incorporating multi-copy orthologs.
}
\details{
\strong{Paper's findings}: Duplicated genes show progressively lower expression
conservation (1:2 < 1:3 < 1:4), EXCEPT for very recent WGD duplicates
(~13 Mya in Glycine max) which show no divergence.

\strong{Strategy recommendations}:
\itemize{
\item Use \code{"strict"} for main analysis (most conservative, publication-ready)
\item Use \code{"best_hit"} for exploratory analysis when need more gene coverage
\item Use \code{"all_pairs"} to study expression divergence among paralogs
\item Avoid \code{"mean"} unless you have biological reason to believe partial sub-functionalization
}
}
\examples{
\dontrun{
# Load orthologs (may contain 1:N and N:M relationships)
orthologs_all <- read.csv("orthologs.csv")

# Strategy 1: Strict (only 1:1, matches paper)
orthologs_1to1 <- handle_multicopy_orthologs(
  orthologs_all,
  strategy = "strict"
)

# Strategy 2: Best hit (when need more coverage)
orthologs_best <- handle_multicopy_orthologs(
  orthologs_all,
  strategy = "best_hit",
  similarity_sp1 = sim_at,
  similarity_sp2 = sim_os
)

# Strategy 3: All pairs (study paralog divergence)
orthologs_all_pairs <- handle_multicopy_orthologs(
  orthologs_all,
  strategy = "all_pairs"
)
}

}
\references{
Grønvold L, Hvidsten TR. Cross species comparative transcriptomics using
co-expression networks.

Ohno S (1970) Evolution by Gene Duplication.
}
