% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ccs.R
\name{calculate_ccs}
\alias{calculate_ccs}
\title{Calculate co-expression correlation score (CCS)}
\usage{
calculate_ccs(sim_sp1, sim_sp2, orthologs, use_only_1to1 = TRUE, n_cores = 1)
}
\arguments{
\item{sim_sp1}{Similarity matrix for species 1 (genes × genes)}

\item{sim_sp2}{Similarity matrix for species 2 (genes × genes)}

\item{orthologs}{Data frame with ortholog pairs. Must have columns:
\itemize{
\item \code{gene_sp1}: Gene IDs from species 1
\item \code{gene_sp2}: Gene IDs from species 2
\item \code{type} (optional): Ortholog type ("1:1", "1:N", "N:1", "N:M")
}}

\item{use_only_1to1}{Logical. If TRUE (default), uses only 1:1 orthologs
as reference (recommended, matches paper). If FALSE, uses all orthologs.}

\item{n_cores}{Integer. Number of cores for parallel computation. Default is
1 (sequential). Set to a higher value to enable parallel processing via
the future/furrr framework. Use \code{parallel::detectCores() - 1} for maximum
parallelization while leaving one core free.}
}
\value{
Data frame with columns:
\itemize{
\item \code{gene_sp1}, \code{gene_sp2}: Ortholog pair
\item \code{ccs}: Co-expression correlation score
\item \code{n_ref}: Number of reference orthologs used
}
}
\description{
Calculates CCS between orthologous genes by correlating their co-expression
patterns with a set of reference 1:1 orthologs. This measures how well
orthologous genes retain the same co-expression partners across species.
}
\details{
For ortholog pair (i, j), CCS is calculated as:
CCS_ij = cor(S^sp1_r,i, S^sp2_r,j)

Where r is the set of 1:1 reference orthologs. Only the rows/columns
corresponding to reference orthologs are correlated.

The reference set should contain unduplicated genes performing ancestral
functions with conserved expression patterns.
\subsection{Parallelization}{

CCS calculation is embarrassingly parallel - each ortholog pair can be
computed independently. For large datasets (>10,000 pairs), parallel
processing can provide 4-8x speedup on multi-core machines.
}
}
\examples{
\dontrun{
# Calculate similarity matrices
sim_at <- calculate_pcc_mr(expr_at)
sim_os <- calculate_pcc_mr(expr_os)

# Define orthologs
orthologs <- data.frame(
  gene_sp1 = c("AT1G01010", "AT1G01020"),
  gene_sp2 = c("Os01g0100100", "Os01g0100200"),
  type = c("1:1", "1:1")
)

# Calculate CCS (sequential)
ccs_results <- calculate_ccs(sim_at, sim_os, orthologs)

# Calculate CCS (parallel with 4 cores)
ccs_results <- calculate_ccs(sim_at, sim_os, orthologs, n_cores = 4)
}

}
\references{
Grønvold L, Hvidsten TR. Cross species comparative transcriptomics using
co-expression networks.
}
